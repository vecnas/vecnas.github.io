<h4>Семафоры</h4>

В случае когда нужны некие флаги уровня приложения, возможно использовать семафоры.
Например, приложение грузит некие критические данные, без которых вся его работа невозможна.
Для использования семафоров - добавьте секцию <b>semaphores</b> в определение приложения:

<pre><code class="js">
    var myApp = {

        .....

        semaphores: {

            userLogged: {
                release: function(user) {},
                on: function(cb) {}
            },

            libDataLoaded: {
                release: function(libData) {},
                on: function(cb) {}
            }

        }
    }

</code></pre>

во время биндинга приложения все методы будут автоматически реализованы Jiant'ом.
Семафоры похожи на события, с той разницей что они сохраняют свое состояние и данные и при последующих вызовах.
Они ведут себя как модели данных, но имеют более адаптированный к конкретным задачам интерфейс.

<h4>Сброс семафора</h4>

Чтобы отпустить семафор, в блоке <b>onUiBound</b> вызовите
<pre><code class="js">

  myApp.semaphores.userLogged.release({userName: "smith"});

  myApp.ajax.getLibData(function(libData) {
      myApp.semaphores.libDataLoaded.release(libData);
  })

</code></pre>

<ul>
  <li>Данные, переданные при сбросе семафора, запоминаются и передаются всем кто подписывается на него как до сброса, так и после</li>
  <li>Семафор может быть сброшен только один раз, последующие вызовы игнорируются</li>
</ul>


<h4>Подписка на семафор</h4>

Где-нибудь в блоке <b>onUiBound</b>, подпишитесь через метод <b>on</b>:

<pre><code class="js">
    myApp.semaphores.userLogged.on(function(user) {
        //обрабатываем данные
    });
</code></pre>

Если семафор уже сброшен - этот код выполнится немедленно, если еще нет - будет ожидать когда кто-нибудь вызовет <b>release</b>.

<h4>Передача данных</h4>

Коллбэк метода <b>on</b> получает в точности все аргументы, переданные в метод <b>release</b>.
Набор данных не зависит от объявленной сигнатуры метода <b>release</b> и зависит только от переданных аргументов во время вызова.
Данные запоминаются при вызове <b>release</b> и в дальнейшем передаются всем последующим вызовам <b>on</b>.

<h4>Для ленивых</h4>

методы <b>release</b> и <b>on</b> нужно определять только для целей автозавершения, документации и удобства.
Они всегда добавляются в семафор, независимо от объявления.
Кратчайшая работающая форма описания семафоров следующая:

<pre><code class="js">
    var myApp = {

        semaphores: {
            userLogged: {},
            libDataLoaded: {}
        }

    }
</code></pre>

Однако не рекомендуется так писать, потому что неясно какие именно данные содержатся в семафоре.
